<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="view_account_revaluation" model="ir.ui.view">
            <field name="name">account.revaluation.form</field>
            <field name="model">account.revaluation</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Revaluate Period Entries">
                <group colspan="8" col="2">
	                   <group colspan="8" col="4">
	                       <field name="period_id" domain="[('state','!=','done')]" required="1" attrs="{'readonly':[('state','!=','draft')]}"/>
	                       <field name="company_id" readonly="1"/>
	                       <field name="comp_curr" readonly="1"/>
	                       <field name="comp_curr_beg_bal" attrs="{'readonly':[('state','!=','draft')]}"/>
	                   </group>
	                   <notebook>
	                   <page string="Currency Lists">
		                    <field colspan="8" mode="tree,form" name="currency_ids" nolabel="1" attrs="{'readonly':[('base','=',True)]}" height="300">
		                        <form string="Currencies">
		                            <field name="currency_id"/>
		                            <field name="beg_bal"/>
		                            <field name="ap_bal"/>
		                            <field name="start_rate"/>
		                            <field name="weighted_rate"/>
									<field name="end_rate" readonly="1"/>
		                            <field name="post_rate"/>
		                        </form>
		                        <tree string="Currencies" editable="bottom">
		                            <field name="currency_id" readonly="1"/>
		                            <field name="beg_bal"/>
	                                <field name="ap_bal"/>
		                            <field name="start_rate" readonly="1"/>
		                            <field name="weighted_rate" readonly="1"/>
									<field name="end_rate" readonly="1"/>
		                            <field name="post_rate"/>
		                        </tree>
							</field>
						</page>
						<page string = "Accounts for Partial Revaluation">
							<field colspan="8" mode="tree,form" name="account_ids" nolabel="1" attrs="{'readonly':[('base','=',True)]}" height="300">
	                            <form string = "Accounts for Partial Revaluation">
	                                <field name="account_id" readonly="1"/>
	                                <field name="bal_beg" readonly="1"/>
	                                <field name="bal_ap" readonly="1"/>
	                                <field name="diff" readonly="1"/>
	                                <field name="bal_end" readonly="1"/>
	                            </form>
	                            <tree string = "Accounts for Partial Revaluation">
	                                <field name="account_id" readonly="1"/>
	                                <field name="bal_beg" readonly="1"/>
	                                <field name="bal_ap" readonly="1"/>
	                                <field name="diff" readonly="1"/>
	                                <field name="bal_end" readonly="1"/>
	                            </tree>
	                        </field>
                        </page>
                        <page string = "Accounting Entries to Revaluate">
                            <field colspan="8" mode="tree,form" name="line_ids" nolabel="1" attrs="{'readonly':[('base','=',True)]}" width="700" height="300">
                                <form string="Journal Items">
                                    <field name="move_line_id" readonly="1"/>
                                    <field name="account_id" readonly="1"/>
                                    <field name="currency_id" readonly="1"/>
                                    <field name="debit" readonly="1" invisible="1"/>
                                    <field name="credit" readonly="1" invisible="1"/>
                                    <field name="post_rate" readonly="1"/>
                                    <field name="reval_amount" readonly="1"/>
                                </form>
                                <tree string="Journal Items" editable="bottom">
                                    <field name="move_line_id" readonly="1"/>
                                    <field name="account_id" readonly="1"/>
                                    <field name="debit" readonly="1" invisible="0"/>
                                    <field name="credit" readonly="1" invisible="0"/>
                                    <field name="currency_id" readonly="1"/>
                                    <field name="amount_currency" readonly="1"/>
                                    <field name="reval_amount" readonly="1"/>
                                    <field name="diff" readonly="1"/>
                                    <field name="bal_ap" readonly="1"/>
                                    <field name="bal_end" readonly="1"/>
                                </tree>
                            </field>
                        </page>
                        <page string = "Gain/Loss Accounts">
                            <field colspan="8" mode="tree,form" name="gain_loss_ids" nolabel="1" attrs="{'readonly':[('base','=',True)]}" width="700" height="300">
                                <form string="Gain/Loss Accounts">
                                    <field name="account_id" readonly="1"/>
                                    <field name="gain_loss" readonly="1"/>
                                </form>
                                <tree string="Gain/Loss Accounts" editable="bottom">
                                    <field name="account_id" readonly="1"/>
                                    <field name="rel_pr_account" readonly="1"/>
                                    <field name="gain_loss" readonly="1"/>
                                </tree>
                            </field>
                        </page>
						</notebook>
						<group colspan="4" col="10">
						<field name="state" readonly="1"/>
						<button string="Get Currencies"
	                                            type="object"
	                                            name="get_details"
	                                            icon="gtk-execute"
	                                            attrs="{'invisible': [('state','!=','draft')]}"
	                                            />
                        <button string="Adjust per Post Rate"
                                                type="object"
                                                name="adjust_post_rate"
                                                icon="gtk-execute"
                                                attrs="{'invisible': [('state','!=','test_reval')]}"
                                                />
                        <button string="Check Gain Loss"
                                                type="object"
                                                name="check_gain_loss_accounts"
                                                icon="gtk-execute"
                                                attrs="{'invisible': [('state','!=','test_reval')]}"
                                                />
                        <button string="Compute Balance AP"
                                                type="object"
                                                name="compute_balap"
                                                icon="gtk-execute"
                                                attrs="{'invisible': [('state','!=','data_fetched')]}"
                                                />
                        <button string="Check Revaluation"
                                                type="object"
                                                name="reval_entries"
                                                icon="gtk-execute"
                                                attrs="{'invisible': [('state','!=','balap_computed')]}"
                                                />
	                    </group>
	           </group>   
               </form>
            </field>
        </record>
        
        <record id="action_account_revaluation" model="ir.actions.act_window">
            <field name="name">Revaluate Entries</field>
            <field name="res_model">account.revaluation</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_account_revaluation"/>
            <field name="target">new</field>
        </record>
        
		<menuitem
            name="Revaluate Entries"
            parent="account.menu_account_end_year_treatments"
            action="action_account_revaluation"
            id="menu_account_revaluation"
            sequence="50"
           />

    </data>
</openerp>
